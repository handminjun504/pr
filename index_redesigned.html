<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²½ë¦¬ì—…ë¬´ë¥¼ì˜í•˜ëŠ”ì²­ë…„ë“¤ - ì„œë¹„ìŠ¤ ì†Œê°œì„œ ìƒì„±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Pretendard:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy: #1a2e4c;
            --navy-light: #2d4a6f;
            --navy-dark: #0f1d30;
            --navy-pale: #e8eef5;
            --accent: #3b7dd8;
            --accent-light: #5a9ae8;
            --text: #2c3e50;
            --text-light: #5a6c7d;
            --text-lighter: #8899a8;
            --bg: #f5f7fa;
            --bg-dark: #e9ecf0;
            --white: #ffffff;
            --border: #d1d9e3;
            --border-light: #e5eaf0;
            --success: #27ae60;
            --warning: #e67e22;
            --ai-purple: #7c3aed;
            --shadow-sm: 0 1px 3px rgba(26, 46, 76, 0.08);
            --shadow: 0 2px 8px rgba(26, 46, 76, 0.12);
            --shadow-lg: 0 4px 16px rgba(26, 46, 76, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
        }

        /* í—¤ë” */
        .app-header {
            background: var(--navy);
            color: white;
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .app-header .logo {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .app-header .logo span {
            color: var(--accent-light);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .header-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .header-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .header-btn svg {
            width: 16px;
            height: 16px;
        }

        .api-status {
            font-size: 12px;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(255,255,255,0.1);
        }

        .api-status.connected {
            background: var(--success);
        }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .main-container {
            display: flex;
            min-height: calc(100vh - 60px);
        }

        /* ì‚¬ì´ë“œë°” - ì…ë ¥ íŒ¨ë„ */
        .sidebar {
            width: 400px;
            background: var(--white);
            border-right: 1px solid var(--border);
            padding: 24px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .sidebar-section {
            margin-bottom: 28px;
        }

        .sidebar-section:last-child {
            margin-bottom: 0;
        }

        .sidebar-title {
            font-size: 13px;
            font-weight: 700;
            color: var(--navy);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 14px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--navy);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 6px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
            background: var(--white);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(59, 125, 216, 0.12);
        }

        /* AI íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
        .ai-upload-section {
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
            border: 2px dashed var(--ai-purple);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            transition: all 0.2s;
        }

        .ai-upload-section:hover {
            background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
        }

        .ai-upload-section.dragging {
            background: #ddd6fe;
            border-color: #7c3aed;
        }

        .ai-upload-section .ai-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .ai-upload-section h4 {
            font-size: 14px;
            font-weight: 700;
            color: var(--ai-purple);
            margin-bottom: 6px;
        }

        .ai-upload-section p {
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 12px;
        }

        .ai-upload-section input[type="file"] {
            display: none;
        }

        .ai-upload-btn {
            background: var(--ai-purple);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .ai-upload-btn:hover {
            background: #6d28d9;
        }

        .ai-upload-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .file-info {
            margin-top: 12px;
            padding: 10px 14px;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            color: var(--text);
            display: none;
        }

        .file-info.show {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .file-info .file-name {
            font-weight: 600;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 200px;
        }

        .file-info .remove-file {
            background: none;
            border: none;
            color: #ef4444;
            cursor: pointer;
            font-size: 16px;
        }

        /* ì„¹ì…˜ ì„¤ëª… */
        .section-desc {
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px dashed var(--border-light);
        }

        /* ì„œë¹„ìŠ¤ ì¹´í…Œê³ ë¦¬ êµ¬ë¶„ */
        .service-category {
            font-size: 11px;
            font-weight: 700;
            color: var(--navy);
            background: var(--navy-pale);
            padding: 6px 10px;
            margin: 8px 0 4px 0;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .service-category:first-child {
            margin-top: 0;
        }

        /* ì¶”ì²œ ì„œë¹„ìŠ¤ ê·¸ë£¹ */
        .recommended-group {
            max-height: 300px;
            overflow-y: auto;
        }

        .recommended-group .checkbox-item {
            padding: 8px 12px;
        }

        .recommended-group .checkbox-item.recommended {
            border-left: 3px solid var(--ai-purple);
        }

        .recommended-group .checkbox-item.recommended.checked {
            background: #f5f3ff;
            border-color: var(--ai-purple);
        }

        /* AI ë¶„ì„ ê²°ê³¼ */
        .ai-result {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 14px;
            margin-top: 12px;
            display: none;
        }

        .ai-result.show {
            display: block;
        }

        .ai-result h5 {
            font-size: 13px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .ai-result p {
            font-size: 12px;
            color: var(--text);
            line-height: 1.6;
        }

        .ai-result .extracted-info {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #86efac;
        }

        .ai-result .info-item {
            display: flex;
            gap: 8px;
            margin-bottom: 4px;
            font-size: 12px;
        }

        .ai-result .info-label {
            font-weight: 600;
            color: var(--text-light);
            min-width: 60px;
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            display: inline-block;
        }

        .spinner.dark {
            border-color: rgba(0,0,0,0.1);
            border-top-color: var(--ai-purple);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px 14px;
            background: var(--bg);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            background: var(--navy-pale);
            border-color: var(--accent);
        }

        .checkbox-item.checked {
            background: var(--navy-pale);
            border-color: var(--navy);
        }

        .checkbox-item.ai-recommended {
            border-color: var(--ai-purple);
            background: #f5f3ff;
        }

        .checkbox-item.ai-recommended::after {
            content: 'AI ì¶”ì²œ';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            background: var(--ai-purple);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .checkbox-item {
            position: relative;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            accent-color: var(--navy);
            cursor: pointer;
            flex-shrink: 0;
        }

        .checkbox-item .checkbox-content {
            flex: 1;
        }

        .checkbox-item .checkbox-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 2px;
        }

        .checkbox-item .checkbox-desc {
            font-size: 12px;
            color: var(--text-light);
            line-height: 1.5;
        }

        /* ë²„íŠ¼ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--navy);
            color: white;
        }

        .btn-primary:hover {
            background: var(--navy-light);
        }

        .btn-secondary {
            background: var(--bg-dark);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #219a52;
        }

        .btn-block {
            width: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        /* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */
        .preview-area {
            flex: 1;
            padding: 32px;
            background: var(--bg-dark);
            overflow-y: auto;
        }

        .preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .preview-header h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--navy);
        }

        .preview-actions {
            display: flex;
            gap: 10px;
        }

        /* ë¬¸ì„œ ì»¨í…Œì´ë„ˆ */
        .document-wrapper {
            max-width: 800px;
            margin: 0 auto;
        }

        .document {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            padding: 56px 64px;
            min-height: 600px;
        }

        /* ë¬¸ì„œ í—¤ë” */
        .doc-header {
            text-align: center;
            margin-bottom: 48px;
            padding-bottom: 32px;
            border-bottom: 2px solid var(--navy);
        }

        .doc-badge {
            display: inline-block;
            background: var(--navy);
            color: white;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }

        .doc-header h1 {
            font-size: 32px;
            font-weight: 800;
            color: var(--navy);
            margin-bottom: 10px;
            letter-spacing: -1px;
        }

        .doc-header .subtitle {
            font-size: 15px;
            color: var(--text-light);
        }

        .doc-client {
            margin-top: 24px;
            padding: 16px 28px;
            background: var(--navy-pale);
            border-radius: 8px;
            display: inline-block;
        }

        .doc-client .client-name {
            font-size: 24px;
            font-weight: 700;
            color: var(--navy);
        }

        .doc-client .client-suffix {
            font-size: 15px;
            color: var(--text-light);
            margin-top: 4px;
        }

        /* ì„¹ì…˜ */
        .doc-section {
            margin-bottom: 40px;
        }

        .doc-section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .doc-section-title .icon {
            width: 32px;
            height: 32px;
            background: var(--navy);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .doc-content {
            color: var(--text);
            line-height: 1.8;
            font-size: 14px;
        }

        .doc-content p {
            margin-bottom: 14px;
        }

        .doc-content strong {
            color: var(--navy);
            font-weight: 600;
        }

        /* ì„œë¹„ìŠ¤ ê·¸ë£¹ */
        .service-group {
            margin-bottom: 32px;
        }

        .service-group-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .service-group-title .count {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-light);
        }

        .service-group-desc {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px dashed var(--border-light);
        }

        .recommended-group-doc {
            background: #faf5ff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e9d5ff;
        }

        /* ì„œë¹„ìŠ¤ ë°•ìŠ¤ */
        .service-box {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .service-box.recommended {
            border-left: 4px solid var(--ai-purple);
            background: #fefcff;
        }

        .service-box.requested {
            border-left: 4px solid var(--navy);
        }

        .service-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-light);
        }

        .service-icon {
            font-size: 24px;
        }

        .service-header h4 {
            flex: 1;
            font-size: 16px;
            font-weight: 700;
            color: var(--navy);
            margin: 0;
        }

        .service-badge {
            font-size: 11px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .badge-requested {
            background: var(--navy-pale);
            color: var(--navy);
        }

        .badge-recommended {
            background: #f3e8ff;
            color: var(--ai-purple);
        }

        .detail-text {
            font-size: 13px;
            line-height: 1.8;
            color: var(--text);
        }

        .sample-report {
            background: var(--navy-pale);
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--navy);
            margin-top: 12px;
            font-weight: 500;
        }

        .service-box:last-child {
            margin-bottom: 0;
        }

        .service-box h4 {
            font-size: 16px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 14px;
            padding-bottom: 10px;
            border-bottom: 1px dashed var(--border);
        }

        .service-box .info-row {
            display: flex;
            margin-bottom: 10px;
            gap: 12px;
        }

        .service-box .info-row:last-child {
            margin-bottom: 0;
        }

        .service-box .info-label {
            width: 80px;
            font-weight: 600;
            color: var(--navy-light);
            font-size: 13px;
            flex-shrink: 0;
        }

        .service-box .info-value {
            color: var(--text);
            font-size: 13px;
            line-height: 1.7;
        }

        .service-box .example {
            background: var(--white);
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-light);
            margin-top: 10px;
            border-left: 3px solid var(--navy);
        }

        /* í•˜ì´ë¼ì´íŠ¸ ë°•ìŠ¤ */
        .highlight-box {
            background: var(--navy-pale);
            border-left: 4px solid var(--navy);
            padding: 20px 24px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .highlight-box h4 {
            font-size: 15px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 8px;
        }

        .highlight-box p {
            margin: 0;
            color: var(--text);
            font-size: 14px;
            line-height: 1.7;
        }

        /* í”„ë¡œì„¸ìŠ¤ */
        .process-flow {
            display: flex;
            justify-content: space-between;
            margin: 28px 0;
            gap: 8px;
            page-break-inside: avoid;
            break-inside: avoid;
        }

        .process-step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .process-step:not(:last-child)::after {
            content: 'â†’';
            position: absolute;
            right: -14px;
            top: 30px;
            color: var(--navy);
            font-size: 18px;
        }

        .process-step .step-num {
            width: 44px;
            height: 44px;
            background: var(--navy);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
            margin: 0 auto 10px;
        }

        .process-step .step-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--navy);
            margin-bottom: 4px;
        }

        .process-step .step-desc {
            font-size: 11px;
            color: var(--text-light);
            line-height: 1.5;
        }

        /* ê°€ê²© ê°•ì¡° */
        .price-banner {
            background: var(--navy);
            color: white;
            text-align: center;
            padding: 28px 32px;
            border-radius: 8px;
            margin: 28px 0;
        }

        .price-banner h3 {
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .price-banner p {
            font-size: 14px;
            opacity: 0.9;
        }

        /* CTA */
        .cta-box {
            background: var(--navy-light);
            color: white;
            text-align: center;
            padding: 32px;
            border-radius: 8px;
            margin-top: 32px;
        }

        .cta-box h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .cta-box p {
            font-size: 14px;
            opacity: 0.95;
            line-height: 1.8;
        }

        /* í‘¸í„° */
        .doc-footer {
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .doc-footer .company {
            font-size: 18px;
            font-weight: 800;
            color: var(--navy);
            margin-bottom: 8px;
        }

        .doc-footer .info {
            font-size: 13px;
            color: var(--text-light);
        }

        .doc-footer .ceo {
            font-weight: 600;
            color: var(--text);
        }

        /* ë¦¬ìŠ¤íŠ¸ */
        .styled-list {
            list-style: none;
            padding: 0;
        }

        .styled-list li {
            padding: 10px 0 10px 20px;
            position: relative;
            border-bottom: 1px dashed var(--border-light);
        }

        .styled-list li:last-child {
            border-bottom: none;
        }

        .styled-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: var(--navy);
            font-weight: bold;
        }

        /* í¸ì§‘ ëª¨ë“œ */
        .edit-mode [data-editable] {
            outline: 2px dashed transparent;
            border-radius: 4px;
            transition: all 0.2s;
            min-height: 1em;
        }

        .edit-mode [data-editable]:hover {
            outline-color: var(--accent);
            background: rgba(59, 125, 216, 0.05);
        }

        .edit-mode [data-editable]:focus {
            outline-color: var(--navy);
            outline-style: solid;
            background: #fffde7;
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 80px 40px;
            color: var(--text-light);
        }

        .empty-state .icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
            line-height: 1.7;
        }

        /* ëª¨ë‹¬ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
                background: white;
            border-radius: 12px;
            padding: 28px;
            width: 90%;
            max-width: 440px;
            box-shadow: var(--shadow-lg);
        }

        .modal h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 16px;
        }

        .modal .form-group {
            margin-bottom: 16px;
        }

        .modal .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal .modal-actions .btn {
            flex: 1;
        }

        /* ì €ì¥ ìƒíƒœ */
        .save-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: #f0f7f0;
            border-radius: 6px;
            font-size: 13px;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }

        .save-status.saving {
            background: #fff8e1;
            color: #f57c00;
            border-color: #ffe082;
        }

        .save-status.saved {
            background: #e8f5e9;
            color: #2e7d32;
            border-color: #a5d6a7;
        }

        .save-icon {
            font-size: 16px;
        }

        .save-status.saving .save-icon {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* í† ìŠ¤íŠ¸ */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--navy);
            color: white;
            padding: 14px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: #ef4444;
        }

        .toast.ai {
            background: var(--ai-purple);
        }

        /* ì„ íƒ ì¹´ìš´íŠ¸ */
        .selection-count {
            background: var(--navy-pale);
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            font-size: 13px;
            color: var(--navy);
            display: flex;
            align-items: center;
                gap: 8px;
            }

        .selection-count strong {
            color: var(--accent);
        }

        /* í”„ë¦°íŠ¸/PDF ìŠ¤íƒ€ì¼ */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            @page {
                size: A4 landscape;
                margin: 10mm 12mm;
            }
            
            html, body {
                width: 100% !important;
                height: auto !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                font-size: 11pt !important;
            }
            
            .app-header, 
            .sidebar, 
            .preview-header,
            .toast { 
                display: none !important; 
            }
            
            .main-content {
                margin-left: 0 !important;
                width: 100% !important;
                padding: 0 !important;
            }
            
            .preview-area { 
                padding: 0 !important; 
                background: white !important; 
            }
            
            .document { 
                box-shadow: none !important; 
                border-radius: 0 !important; 
                padding: 0 !important;
                margin: 0 !important;
                max-width: 100% !important;
                width: 100% !important;
            }
            
            .edit-mode [data-editable] { 
                outline: none !important; 
            }
            
            /* ì„œë¹„ìŠ¤ ë°•ìŠ¤ ì¸ì‡„ ìµœì í™” */
            .service-box {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                margin-bottom: 15px !important;
                border: 1px solid #ddd !important;
            }
            
            .service-group {
                page-break-before: auto;
            }
            
            .service-group:not(:first-child) {
                page-break-before: always;
            }
            
            /* ëª¨ë“  ë°°ê²½ìƒ‰ ì¸ì‡„ ì‹œ ìœ ì§€ */
            .doc-badge,
            .doc-client,
            .service-badge,
            .sample-report,
            .core-services-grid .service-card,
            .highlight-box,
            .process-step,
            .erp-promo,
            .cta-section,
            .footer-section {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .doc-badge {
                background: #1a365d !important;
                color: white !important;
            }
            
            .doc-client {
                background: #ebf4ff !important;
            }
            
            .service-box {
                background: white !important;
                border: 1px solid #e2e8f0 !important;
            }
            
            .sample-report {
                background: #f0fdf4 !important;
            }
            
            .highlight-box {
                background: #fffbeb !important;
            }
            
            .cta-section {
                background: #ebf4ff !important;
            }
            
            /* í”„ë¡œì„¸ìŠ¤ í”Œë¡œìš° ì˜ë¦¼ ë°©ì§€ */
            .process-flow {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            .process-step .step-num {
                background: #1a365d !important;
                color: white !important;
            }
            
            /* ë¹„ìš© ì‚°ì • ì„¹ì…˜ ì „ì²´ ì˜ë¦¼ ë°©ì§€ */
            .doc-section:has(.process-flow) {
                page-break-inside: avoid !important;
            }
            
            .price-banner {
                background: #1a365d !important;
                color: white !important;
                page-break-inside: avoid !important;
            }
            
            .cta-box {
                page-break-inside: avoid !important;
            }
        }

        /* í˜ì´ì§€ ë¸Œë ˆì´í¬ */
        .page-break-before { 
            page-break-before: always; 
            break-before: page;
        }
        .page-break-after { 
            page-break-after: always; 
            break-after: page;
        }
        .no-break { 
            page-break-inside: avoid; 
            break-inside: avoid;
        }

        /* PDFìš© ì„œë¹„ìŠ¤ ê·¸ë¦¬ë“œ - 2ì—´ ë ˆì´ì•„ì›ƒ (A4 ê°€ë¡œ ìµœì í™”) */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .service-grid .service-box {
            margin-bottom: 0;
            padding: 16px 20px;
            page-break-inside: avoid;
            break-inside: avoid;
            box-sizing: border-box;
        }

        .service-grid .service-header {
            margin-bottom: 12px;
            padding-bottom: 10px;
        }

        .service-grid .service-header h4 {
            font-size: 15px;
        }

        .service-grid .service-icon {
            font-size: 20px;
        }

        .service-grid .info-row {
            padding: 6px 0;
        }

        .service-grid .info-label {
            font-size: 11px;
            min-width: 70px;
        }

        .service-grid .info-value {
            font-size: 12px;
            line-height: 1.5;
        }

        .service-grid .detail-text {
            font-size: 12px;
            line-height: 1.6;
        }

        .service-grid .sample-report {
            font-size: 11px;
            padding: 8px 12px;
            margin-top: 10px;
        }
        
        @media print {
            .service-grid {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 16px !important;
            }
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 1024px) {
            .main-container { flex-direction: column; }
            .sidebar { width: 100%; border-right: none; border-bottom: 1px solid var(--border); max-height: 50vh; }
            .preview-area { padding: 20px; }
            .document { padding: 40px 32px; }
        }

        @media (max-width: 600px) {
            .app-header { padding: 12px 16px; flex-direction: column; gap: 10px; }
            .sidebar { padding: 16px; }
            .document { padding: 32px 24px; }
            .doc-header h1 { font-size: 24px; }
            .process-flow { flex-direction: column; gap: 16px; }
            .process-step:not(:last-child)::after { content: 'â†“'; position: static; display: block; margin-top: 8px; }
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <header class="app-header">
        <div class="logo">ì£¼ì‹íšŒì‚¬ <span>ê²½ë¦¬ì—…ë¬´ë¥¼ì˜í•˜ëŠ”ì²­ë…„ë“¤</span></div>
        <div class="header-actions">
            <span style="font-size: 13px; color: rgba(255,255,255,0.8);">ì„œë¹„ìŠ¤ ì†Œê°œì„œ ìƒì„±ê¸°</span>
    </div>
    </header>

    <div class="main-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <!-- ê¸°ì—… ì •ë³´ -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">ğŸ“‹ ê¸°ì—… ì •ë³´</h3>
                <div class="form-group">
                    <label for="companyName">ìƒë‹´ ê¸°ì—…ëª… *</label>
                    <input type="text" id="companyName" placeholder="ì˜ˆ: ABC ì£¼ì‹íšŒì‚¬" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="contactName">ë‹´ë‹¹ì/ëŒ€í‘œìëª…</label>
                    <input type="text" id="contactName" placeholder="ì˜ˆ: í™ê¸¸ë™ ëŒ€í‘œë‹˜" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="industryType">ì—…ì¢…</label>
                    <select id="industryType" onchange="updatePreview()">
                        <option value="">ì„ íƒ ì•ˆí•¨</option>
                        <option value="ì œì¡°ì—…">ì œì¡°ì—…</option>
                        <option value="ìœ í†µ/ë„ë§¤ì—…">ìœ í†µ/ë„ë§¤ì—…</option>
                        <option value="ì†Œë§¤ì—…">ì†Œë§¤ì—…</option>
                        <option value="ì„œë¹„ìŠ¤ì—…">ì„œë¹„ìŠ¤ì—…</option>
                        <option value="IT/ì†Œí”„íŠ¸ì›¨ì–´">IT/ì†Œí”„íŠ¸ì›¨ì–´</option>
                        <option value="ê±´ì„¤ì—…">ê±´ì„¤ì—…</option>
                        <option value="ìš”ì‹ì—…">ìš”ì‹ì—…</option>
                        <option value="ì˜ë£Œ/í—¬ìŠ¤ì¼€ì–´">ì˜ë£Œ/í—¬ìŠ¤ì¼€ì–´</option>
                        <option value="ìš´ì†¡/ë¬¼ë¥˜ì—…">ìš´ì†¡/ë¬¼ë¥˜ì—…</option>
                        <option value="êµìœ¡ì—…">êµìœ¡ì—…</option>
                        <option value="ë¶€ë™ì‚°ì—…">ë¶€ë™ì‚°ì—…</option>
                    </select>
                </div>
            </div>

            <!-- ê³ ê° ìš”ì²­ ì„œë¹„ìŠ¤ -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">ğŸ“Œ ê³ ê° ìš”ì²­ ì„œë¹„ìŠ¤</h3>
                <p class="section-desc">ê³ ê°ì‚¬ì—ì„œ í•„ìš”í•˜ë‹¤ê³  ìš”ì²­í•œ ì„œë¹„ìŠ¤</p>
                <div class="selection-count" id="requestedCount">
                    ì„ íƒ: <strong>0ê°œ</strong>
                    </div>
                <div class="checkbox-group" id="requestedServices">
                    <!-- ê¸°ë³¸ ê´€ë¦¬ -->
                    <div class="service-category">ê¸°ë³¸ ê´€ë¦¬</div>
                    <label class="checkbox-item" data-service="accountManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'accountManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ¦ ì‚¬ì—…ìš© ê³„ì¢Œê´€ë¦¬</div>
                            <div class="checkbox-desc">ì…ì¶œê¸ˆ ëª¨ë‹ˆí„°ë§ ë° ìê¸ˆíë¦„ ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="cardManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'cardManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’³ ë“±ë¡ì¹´ë“œ ê´€ë¦¬</div>
                            <div class="checkbox-desc">ë²•ì¸/ì‚¬ì—…ìš© ì¹´ë“œ ì‚¬ìš©ë‚´ì—­ ì¦ë¹™ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="partnerManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'partnerManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ‘¥ ê±°ë˜ì²˜ ë° ì§ì›ê´€ë¦¬</div>
                            <div class="checkbox-desc">ê±°ë˜ì²˜/ì§ì› ì •ë³´ ì²´ê³„ì  ê´€ë¦¬</div>
                        </div>
                    </label>
                    <!-- ì„¸ê¸ˆê³„ì‚°ì„œ -->
                    <div class="service-category">ì„¸ê¸ˆê³„ì‚°ì„œ</div>
                    <label class="checkbox-item" data-service="taxInvoiceIssue" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'taxInvoiceIssue', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“„ ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰</div>
                            <div class="checkbox-desc">í˜‘ì˜ ì‹œê°„ì— ì¼ê´„ ë°œí–‰</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="taxInvoiceCheck" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'taxInvoiceCheck', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ” ì„¸ê¸ˆê³„ì‚°ì„œ ì¡°íšŒ/ê´€ë¦¬</div>
                            <div class="checkbox-desc">í™ˆíƒìŠ¤ ì—°ë™ ì„¸ê¸ˆê³„ì‚°ì„œ ê´€ë¦¬</div>
                        </div>
                    </label>
                    <!-- ì†ìµ ë¶„ì„ -->
                    <div class="service-category">ì†ìµ ë¶„ì„</div>
                    <label class="checkbox-item" data-service="monthlyPL" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'monthlyPL', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ˆ ì›”ê°„ ì†ìµë¶„ì„</div>
                            <div class="checkbox-desc">ì›”ë³„ ì†ìµê³„ì‚°ì„œ ì œê³µ</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="projectPL" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'projectPL', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ—ï¸ í”„ë¡œì íŠ¸/í˜„ì¥ë³„ ì†ìµ</div>
                            <div class="checkbox-desc">í”„ë¡œì íŠ¸ë³„ ìˆ˜ìµë¥  ë¶„ì„</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="salesManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'salesManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’° í’ˆëª©ë³„/ë§¤ì¶œê´€ë¦¬</div>
                            <div class="checkbox-desc">í’ˆëª©/í”„ë¡œì íŠ¸ë³„ ë§¤ì¶œ ì¶”ì </div>
                        </div>
                    </label>
                    <!-- ìê¸ˆ ê´€ë¦¬ -->
                    <div class="service-category">ìê¸ˆ ê´€ë¦¬</div>
                    <label class="checkbox-item" data-service="arApManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'arApManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“‹ ë¯¸ìˆ˜/ë¯¸ì§€ê¸‰ê¸ˆ ê´€ë¦¬</div>
                            <div class="checkbox-desc">ê±°ë˜ì²˜ë³„ ì±„ê¶Œ/ì±„ë¬´ ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="cashFlowManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'cashFlowManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’µ ìê¸ˆí˜„í™© ê´€ë¦¬</div>
                            <div class="checkbox-desc">ìê¸ˆì¼ë³´, ìê¸ˆê³„íš ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="bankReconciliation" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'bankReconciliation', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ”„ ì…ì¶œê¸ˆë‚´ì—­ ëŒ€ì‚¬</div>
                            <div class="checkbox-desc">ì¦ë¹™-ì…ì¶œê¸ˆ ë§¤ì¹­ ê´€ë¦¬</div>
                        </div>
                    </label>
                    <!-- ì¦ë¹™/ì„¸ë¬´ -->
                    <div class="service-category">ì¦ë¹™/ì„¸ë¬´</div>
                    <label class="checkbox-item" data-service="documentManagement" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'documentManagement', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ ì¦ë¹™ê´€ë¦¬</div>
                            <div class="checkbox-desc">ëª¨ë“  ì¦ë¹™ ì²´ê³„ì  ìˆ˜ì§‘/ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="taxSupport" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'taxSupport', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ ì„¸ë¬´ì‹ ê³  ë³´ì¡°ìë£Œ</div>
                            <div class="checkbox-desc">ë¶€ê°€ì„¸/ì›ì²œì„¸ ì‹ ê³  ìë£Œ</div>
                        </div>
                    </label>
                    <!-- ê¸°íƒ€ -->
                    <div class="service-category">ê¸°íƒ€ ì„œë¹„ìŠ¤</div>
                    <label class="checkbox-item" data-service="statementIssue" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'statementIssue', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ƒ ê±°ë˜ëª…ì„¸í‘œ ì œì‘</div>
                            <div class="checkbox-desc">ê±°ë˜ì²˜ìš© ëª…ì„¸í‘œ ì‘ì„±</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="payroll" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'payroll', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’¼ ê¸‰ì—¬ ì •ì‚°</div>
                            <div class="checkbox-desc">ê¸‰ì—¬ëŒ€ì¥ ì‘ì„±, ì›ì²œì„¸ ì§€ì›</div>
                        </div>
                    </label>
                    <label class="checkbox-item" data-service="customTool" data-type="requested">
                        <input type="checkbox" onchange="toggleService(this, 'customTool', 'requested')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ› ï¸ ë§ì¶¤ ë„êµ¬ ê°œë°œ</div>
                            <div class="checkbox-desc">ì—…ë¬´ íŠ¹í™” ì–‘ì‹/ë„êµ¬ ì œì‘</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- ê²½ì²­ ì¶”ì²œ ì„œë¹„ìŠ¤ -->
            <div class="sidebar-section">
                <h3 class="sidebar-title" style="color: var(--ai-purple);">ğŸ’¡ ê²½ì²­ ì¶”ì²œ ì„œë¹„ìŠ¤</h3>
                <p class="section-desc">ê²½ì²­ì—ì„œ ì¶”ê°€ë¡œ ì œì•ˆë“œë¦¬ëŠ” ì„œë¹„ìŠ¤</p>
                <div class="selection-count" id="recommendedCount">
                    ì„ íƒ: <strong>0ê°œ</strong>
                    </div>
                <div class="checkbox-group recommended-group" id="recommendedServices">
                    <!-- ë™ì¼í•œ ì„œë¹„ìŠ¤ ëª©ë¡ (ì¶”ì²œìš©) -->
                    <label class="checkbox-item recommended" data-service="accountManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'accountManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ¦ ì‚¬ì—…ìš© ê³„ì¢Œê´€ë¦¬</div>
                    </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="cardManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'cardManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’³ ë“±ë¡ì¹´ë“œ ê´€ë¦¬</div>
                    </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="partnerManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'partnerManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ‘¥ ê±°ë˜ì²˜ ë° ì§ì›ê´€ë¦¬</div>
                    </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="taxInvoiceIssue" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'taxInvoiceIssue', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“„ ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="taxInvoiceCheck" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'taxInvoiceCheck', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ” ì„¸ê¸ˆê³„ì‚°ì„œ ì¡°íšŒ/ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="monthlyPL" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'monthlyPL', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ˆ ì›”ê°„ ì†ìµë¶„ì„</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="projectPL" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'projectPL', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ—ï¸ í”„ë¡œì íŠ¸/í˜„ì¥ë³„ ì†ìµ</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="salesManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'salesManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’° í’ˆëª©ë³„/ë§¤ì¶œê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="arApManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'arApManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“‹ ë¯¸ìˆ˜/ë¯¸ì§€ê¸‰ê¸ˆ ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="cashFlowManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'cashFlowManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’µ ìê¸ˆí˜„í™© ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="bankReconciliation" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'bankReconciliation', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ”„ ì…ì¶œê¸ˆë‚´ì—­ ëŒ€ì‚¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="documentManagement" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'documentManagement', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ ì¦ë¹™ê´€ë¦¬</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="taxSupport" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'taxSupport', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ ì„¸ë¬´ì‹ ê³  ë³´ì¡°ìë£Œ</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="statementIssue" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'statementIssue', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ“ƒ ê±°ë˜ëª…ì„¸í‘œ ì œì‘</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="payroll" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'payroll', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ’¼ ê¸‰ì—¬ ì •ì‚°</div>
                        </div>
                    </label>
                    <label class="checkbox-item recommended" data-service="customTool" data-type="recommended">
                        <input type="checkbox" onchange="toggleService(this, 'customTool', 'recommended')">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ğŸ› ï¸ ë§ì¶¤ ë„êµ¬ ê°œë°œ</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- ì¶”ê°€ ì˜µì…˜ -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">âš™ï¸ ì¶”ê°€ ì˜µì…˜</h3>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="optExistingStaff" onchange="updatePreview()">
                        <div class="checkbox-content">
                            <div class="checkbox-title">ê¸°ì¡´ ê²½ë¦¬ì§ì› ë³´ìœ </div>
                            <div class="checkbox-desc">í‡´ì‚¬ ë¦¬ìŠ¤í¬ ìµœì†Œí™” ë‚´ìš© ê°•ì¡°</div>
                    </div>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="optErpPromo" onchange="updatePreview()" checked>
                        <div class="checkbox-content">
                            <div class="checkbox-title">ê²½ë¦¬ë‚˜ë¼ ë¬´ë£Œì²´í—˜ ì•ˆë‚´</div>
                            <div class="checkbox-desc">3ê°œì›” ë¬´ë£Œì²´í—˜ê¶Œ ì§€ê¸‰ ì•ˆë‚´ í¬í•¨</div>
                    </div>
                    </label>
                    </div>
                </div>

            <!-- ë²„íŠ¼ -->
            <div class="sidebar-section">
                <button class="btn btn-primary btn-block" onclick="toggleEditMode()" id="editBtn">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    ë‚´ìš© í¸ì§‘ ëª¨ë“œ
                </button>
                <div style="height: 10px;"></div>
                <button class="btn btn-success btn-block" onclick="exportToPDF()" id="pdfBtn">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    PDF ë‚´ë³´ë‚´ê¸°
                </button>
                <div style="height: 10px;"></div>
                <button class="btn btn-block" style="background: #4a5568; color: white;" onclick="printDocument()" id="printBtn">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                    ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°
                </button>
                    </div>

            <!-- ì €ì¥ ìƒíƒœ -->
            <div class="sidebar-section" id="saveStatusSection">
                <div class="save-status" id="saveStatus">
                    <span class="save-icon">ğŸ’¾</span>
                    <span class="save-text" id="saveStatusText">ìˆ˜ì • ë‚´ìš©ì´ ìë™ ì €ì¥ë©ë‹ˆë‹¤</span>
                    </div>
                <button class="btn btn-secondary btn-block" onclick="manualSave()" style="margin-top: 10px;">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:16px;height:16px;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                    ìˆ˜ë™ ì €ì¥
                </button>
                </div>
        </aside>

        <!-- ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ -->
        <main class="preview-area">
            <div class="preview-header">
                <h2>ğŸ“„ ë¯¸ë¦¬ë³´ê¸°</h2>
                <div class="preview-actions">
                    <button class="btn btn-secondary" onclick="resetAll()">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:16px;height:16px;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        ì´ˆê¸°í™”
                    </button>
                    </div>
                </div>

            <div class="document-wrapper">
                <div class="document" id="document">
                    <!-- ë¹ˆ ìƒíƒœ -->
                    <div class="empty-state" id="emptyState">
                        <div class="icon">ğŸ“‹</div>
                        <h3>ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
                        <p>ì™¼ìª½ íŒ¨ë„ì—ì„œ ê¸°ì—…ëª…ì„ ì…ë ¥í•˜ê³ <br>ì œê³µí•  ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ë©´<br>ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>

                    <!-- ë¬¸ì„œ ë‚´ìš© -->
                    <div id="documentContent" style="display: none;">
                        <div class="doc-header">
                            <div class="doc-badge">SERVICE PROPOSAL</div>
                            <h1 data-editable data-key="doc_title">ê²½ë¦¬ì—…ë¬´ ëŒ€í–‰ ì„œë¹„ìŠ¤ ì†Œê°œì„œ</h1>
                            <p class="subtitle" data-editable data-key="doc_subtitle">ì•ˆì •ì ì¸ ê²½ì˜ í™˜ê²½ ì¡°ì„±ì„ ìœ„í•œ ì „ë¬¸ ê²½ë¦¬ ì„œë¹„ìŠ¤</p>
                            <div class="doc-client">
                                <div class="client-name" id="docClientName">ê·€ì‚¬</div>
                                <div class="client-suffix">ë¥¼ ìœ„í•œ ë§ì¶¤ ì„œë¹„ìŠ¤ë¥¼ ì œì•ˆë“œë¦½ë‹ˆë‹¤</div>
                </div>
            </div>

                        <div class="doc-section">
                            <h2 class="doc-section-title">
                                <span class="icon">ğŸ’¡</span>
                                <span>ì„œë¹„ìŠ¤ ì†Œê°œ</span>
                </h2>
                            <div class="doc-content">
                                <p data-editable data-key="doc_intro">
                                    <strong>ì£¼ì‹íšŒì‚¬ ê²½ë¦¬ì—…ë¬´ë¥¼ì˜í•˜ëŠ”ì²­ë…„ë“¤</strong>ì€ ì›ê²©ìœ¼ë¡œ ê²½ë¦¬ì—…ë¬´ë¥¼ ëŒ€í–‰í•´ë“œë¦¬ëŠ” ì „ë¬¸ ì„œë¹„ìŠ¤ ê¸°ì—…ì…ë‹ˆë‹¤.
                                    ìíƒê·¼ë¬´í•˜ëŠ” ê²½ë¦¬ì§ì›ì„ ì±„ìš©í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ íš¨ê³¼ë¥¼ ëˆ„ë¦¬ì‹¤ ìˆ˜ ìˆìœ¼ë©°, 
                                    <strong>ì§ì ‘ ê³ ìš© ëŒ€ë¹„ ë¹„ìš© ì ˆê°</strong>ê³¼ <strong>ì „ë¬¸ì„±</strong>ì„ ë™ì‹œì— í™•ë³´í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                </p>
                                <div class="highlight-box" id="existingStaffBox" style="display: none;">
                                    <h4>ğŸ¯ ê¸°ì¡´ ê²½ë¦¬ ì§ì›ì´ ìˆì–´ë„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤!</h4>
                                    <p data-editable data-key="doc_existing_staff">í‡´ì‚¬ ë¦¬ìŠ¤í¬ ìµœì†Œí™”, ì—…ë¬´ ë°±ì—… ì²´ê³„ êµ¬ì¶•, ì „ë¬¸ ì—…ë¬´ ë¶„ë‹´ ë“± ë‹¤ì–‘í•œ í˜•íƒœë¡œ í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>

                        <div class="doc-section page-break-before" id="selectedServicesSection" style="display: none;">
                            <h2 class="doc-section-title">
                                <span class="icon">âš¡</span>
                                <span>ì œê³µ ì„œë¹„ìŠ¤ ìƒì„¸</span>
                            </h2>
                            <div id="selectedServicesContent"></div>
                        </div>

                        <div class="doc-section policy-section page-break-before">
                            <h2 class="doc-section-title">
                                <span class="icon">ğŸ’¬</span>
                                <span>ì—…ë¬´ ì†Œí†µ ë° ìš´ì˜ ì •ì±…</span>
                            </h2>
                            <div class="doc-content">
                                <p data-editable data-key="doc_policy_intro">ì €í¬ëŠ” ë‹¤ìˆ˜ì˜ ê³ ê°ì‚¬ë¥¼ ì „ë¬¸ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì•„ì›ƒì†Œì‹± ì—…ì²´ë¡œì„œ, ì—…ë¬´ íš¨ìœ¨ê³¼ ì„œë¹„ìŠ¤ í’ˆì§ˆ ìœ ì§€ë¥¼ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì†Œí†µ ì›ì¹™ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>
                                <ul class="styled-list">
                                    <li data-editable data-key="doc_policy_1"><strong>ë¹„ìƒì£¼ ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±:</strong> ë‹´ë‹¹ ë§¤ë‹ˆì €ê°€ ì—¬ëŸ¬ íšŒì›ì‚¬ë¥¼ ë™ì‹œì— ê´€ë¦¬í•˜ë¯€ë¡œ, ì‚¬ë‚´ ìƒì£¼ ì§ì›ì²˜ëŸ¼ ë¬¼ë¦¬ì ì¸ ì‹¤ì‹œê°„ ì¦‰ê° ëŒ€ì‘ì€ êµ¬ì¡°ì ìœ¼ë¡œ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                                    <li data-editable data-key="doc_policy_2"><strong>ìœ ì—°í•œ ì†Œí†µ:</strong> ì „í™” ìƒë‹´ ë° ë©”ì‹ ì € ì†Œí†µì€ ì–¸ì œë“  ì—´ë ¤ ìˆìœ¼ë©°, ê°€ëŠ¥í•œ ë²”ìœ„ ë‚´ì—ì„œëŠ” ìµœëŒ€í•œ ì‹ ì†í•˜ê²Œ ëŒ€ì‘í•´ ë“œë¦½ë‹ˆë‹¤.</li>
                    </ul>
                </div>
            </div>

                        <div class="doc-section" id="erpSection" style="display: none;">
                            <h2 class="doc-section-title">
                    <span class="icon">ğŸ–¥ï¸</span>
                                <span>ERP ì‹œìŠ¤í…œ ì•ˆë‚´</span>
                </h2>
                            <div class="highlight-box">
                                <h4 data-editable data-key="doc_erp_title">ğŸ ê²½ë¦¬ë‚˜ë¼ 3ê°œì›” ë¬´ë£Œì²´í—˜ê¶Œ ì§€ê¸‰!</h4>
                                <p data-editable data-key="doc_erp_desc">ì„œë¹„ìŠ¤ ì´ìš© ì‹œ ì „ë¬¸ ERP í”„ë¡œê·¸ë¨ <strong>'ê²½ë¦¬ë‚˜ë¼'</strong>ë¥¼ í™œìš©í•˜ë©°, ê³„ì•½ ê³ ê°ì‚¬ì— <strong>3ê°œì›”ê°„ ë¬´ë£Œì²´í—˜ê¶Œ</strong>ì„ ì§€ê¸‰í•´ ë“œë¦½ë‹ˆë‹¤.</p>
                </div>
            </div>

                        <div class="doc-section">
                            <h2 class="doc-section-title">
                    <span class="icon">ğŸ“</span>
                                <span>ë¹„ìš© ì‚°ì • ë° ê³„ì•½ ì ˆì°¨</span>
                </h2>
                            <div class="doc-content">
                                <p data-editable data-key="doc_cost_intro">ê²½ë¦¬ ì—…ë¬´ëŠ” ì—…ì¢…ê³¼ íšŒì‚¬ ê·œëª¨ì— ë”°ë¼ ì—…ë¬´ëŸ‰ì˜ í¸ì°¨ê°€ í½ë‹ˆë‹¤. ë”°ë¼ì„œ í•©ë¦¬ì ì´ê³  ì •í™•í•œ ìˆ˜ìˆ˜ë£Œ ì‚°ì •ì„ ìœ„í•´ <strong>ìƒ˜í”Œ í…ŒìŠ¤íŠ¸ ê¸°ê°„</strong>ì„ ìš´ì˜í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="process-flow">
                    <div class="process-step">
                                    <div class="step-num">1</div>
                                    <div class="step-title" data-editable data-key="doc_step1_title">ìƒ˜í”Œ í…ŒìŠ¤íŠ¸</div>
                                    <div class="step-desc" data-editable data-key="doc_step1_desc">ì•½ 1~2ì£¼<br>ì‹¤ì œ ì—…ë¬´ ìˆ˜í–‰</div>
                    </div>
                    <div class="process-step">
                                    <div class="step-num">2</div>
                                    <div class="step-title" data-editable data-key="doc_step2_title">ì—…ë¬´ ë³´ê³ </div>
                                    <div class="step-desc" data-editable data-key="doc_step2_desc">ìˆ˜í–‰ ë¦¬í¬íŠ¸<br>ë°©í–¥ì„± ê²€ì¦</div>
                    </div>
                    <div class="process-step">
                                    <div class="step-num">3</div>
                                    <div class="step-title" data-editable data-key="doc_step3_title">ìµœì¢… ê²¬ì </div>
                                    <div class="step-desc" data-editable data-key="doc_step3_desc">ì—…ë¬´ ë²”ìœ„ í™•ì •<br>ì›” ìˆ˜ìˆ˜ë£Œ ì œì•ˆ</div>
                    </div>
                    <div class="process-step">
                                    <div class="step-num">4</div>
                                    <div class="step-title" data-editable data-key="doc_step4_title">ì •ì‹ ê³„ì•½</div>
                                    <div class="step-desc" data-editable data-key="doc_step4_desc">ê³„ì•½ ì²´ê²°<br>ì›” ì •ê¸° ì„œë¹„ìŠ¤</div>
                    </div>
                </div>
                <div class="highlight-box">
                    <h4>ğŸ“Œ ì„œë¹„ìŠ¤ ê¸ˆì•¡ ì•ˆë‚´</h4>
                                <p data-editable data-key="doc_price_info">ì„œë¹„ìŠ¤ ê¸ˆì•¡ì€ ê·€ì‚¬ì˜ ì—…ë¬´ ë²”ìœ„ì™€ ë‚´ìš©ì— ë”°ë¼ ë‹¬ë¼ì§€ë©°, ì •í•´ì§„ ê¸ˆì•¡ì´ ì—†ìŠµë‹ˆë‹¤. ìƒ˜í”Œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ì‹¤ì œ íˆ¬ì…ë˜ëŠ” ê³µìˆ˜ë¥¼ íŒŒì•…í•œ í›„ í•©ë¦¬ì ì¸ ì›” ìˆ˜ìˆ˜ë£Œë¥¼ ì œì•ˆë“œë¦½ë‹ˆë‹¤.</p>
                </div>
            </div>

                        <div class="price-banner">
                            <h3 data-editable data-key="doc_price_banner">ğŸ’° ì¸ê±´ë¹„ë³´ë‹¤ ë¬´ì¡°ê±´ ì €ë ´í•©ë‹ˆë‹¤!</h3>
                            <p data-editable data-key="doc_price_banner_desc">ì •ê·œì§ ê²½ë¦¬ ì±„ìš© ëŒ€ë¹„ í•©ë¦¬ì ì¸ ë¹„ìš©ìœ¼ë¡œ ì „ë¬¸ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

                        <div class="cta-box">
                            <h3 data-editable data-key="doc_cta_title">ğŸ¯ 1ë‹¬ ë¬´ë£Œ ì²´í—˜ìœ¼ë¡œ ì§ì ‘ í™•ì¸í•´ë³´ì„¸ìš”!</h3>
                            <p data-editable data-key="doc_cta_desc">
                    ì €í¬ ì„œë¹„ìŠ¤ëŠ” <strong>1ë‹¬ ë¬´ë£Œ ì²´í—˜</strong>ì„ í†µí•´ ì—…ë¬´ ëŠ¥ë ¥ì„ ë¨¼ì € í™•ì¸í•´ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                    ê·€ì‚¬ì˜ ëŒ€í‘œë‹˜ê³¼ ì¶©ë¶„íˆ ì†Œí†µí•˜ë©° ì—…ë¬´ ë°©ì‹ì„ ë§ì¶°ê°€ê³ ,<br>
                    ì´í›„ ê³„ì•½ ì˜ì‚¬ë¥¼ ë°í˜€ì£¼ì‹œë©´ ì„œë¹„ìŠ¤ ê¸ˆì•¡ì„ ì‚°ì •í•˜ì—¬ ì›” ì •ê¸° ê²°ì œë¡œ ì§„í–‰ë©ë‹ˆë‹¤.<br><br>
                                <strong>ë¶€ë‹´ ì—†ì´ ê²½í—˜í•´ë³´ì‹œê³ , ê¸ì •ì ìœ¼ë¡œ ê²€í†  ë¶€íƒë“œë¦½ë‹ˆë‹¤!</strong>
                </p>
            </div>

                        <div class="doc-footer">
                            <div class="company" data-editable data-key="doc_company_name">ì£¼ì‹íšŒì‚¬ ê²½ë¦¬ì—…ë¬´ë¥¼ì˜í•˜ëŠ”ì²­ë…„ë“¤</div>
                <div class="info">
                                <span class="ceo" data-editable data-key="doc_ceo">ëŒ€í‘œ ê¸ˆì¢…ì„</span><br>
                                <span data-editable data-key="doc_company_desc">ì›ê²© ê²½ë¦¬ì—…ë¬´ ì „ë¬¸ ì„œë¹„ìŠ¤ ê¸°ì—…</span>
                </div>
            </div>
        </div>
                </div>
            </div>
        </main>
    </div>

    <!-- í† ìŠ¤íŠ¸ -->
    <div class="toast" id="toast">
        <span id="toastMessage">ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</span>
    </div>

    <script>
        // ìƒíƒœ
        let requestedServices = new Set();  // ê³ ê° ìš”ì²­ ì„œë¹„ìŠ¤
        let recommendedServices = new Set(); // ê²½ì²­ ì¶”ì²œ ì„œë¹„ìŠ¤
        let isEditMode = false;
        let saveTimeout = null;

        // ê¸°ë³¸ ì„œë¹„ìŠ¤ ë°ì´í„° (ëª¨ë“ˆí™”)
        const defaultServiceData = {
            // === ê¸°ë³¸ ê´€ë¦¬ ì„œë¹„ìŠ¤ ===
            accountManagement: {
                category: 'ê¸°ë³¸ ê´€ë¦¬',
                title: 'ì‚¬ì—…ìš© ê³„ì¢Œê´€ë¦¬',
                icon: 'ğŸ¦',
                method: 'ì‚¬ì—…ìš© ê³„ì¢Œì˜ ì…ì¶œê¸ˆ ë‚´ì—­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³ , ê±°ë˜ ìœ í˜•ë³„ë¡œ ë¶„ë¥˜í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ê³„ì¢Œë³„ ì…ì¶œê¸ˆ í˜„í™© ì¼ì¼/ì£¼ê°„/ì›”ê°„ ë¦¬í¬íŠ¸ ì œê³µ\nâ€¢ ì´ì²´ ë‚´ì—­ê³¼ ì„¸ê¸ˆê³„ì‚°ì„œ/ì¹´ë“œë§¤ì¶œ ìë™ ë§¤ì¹­\nâ€¢ ë¯¸í™•ì¸ ì…ê¸ˆ ì•Œë¦¼ ë° ì¶”ì  ê´€ë¦¬',
                effect: 'ìê¸ˆ íë¦„ì„ íˆ¬ëª…í•˜ê²Œ íŒŒì•…í•˜ê³ , íšŒê³„ ì²˜ë¦¬ ëˆ„ë½ì„ ë°©ì§€í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ê³„ì¢Œë³„ ì”ì•¡í˜„í™©í‘œ, ì¼ì¼ ì…ì¶œê¸ˆ ëª…ì„¸ì„œ'
            },
            cardManagement: {
                category: 'ê¸°ë³¸ ê´€ë¦¬',
                title: 'ë“±ë¡ì¹´ë“œ ê´€ë¦¬',
                icon: 'ğŸ’³',
                method: 'ë²•ì¸/ì‚¬ì—…ìš© ì¹´ë“œ ì‚¬ìš©ë‚´ì—­ì„ ìˆ˜ì§‘í•˜ê³ , ì ê²©ì¦ë¹™ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ì¹´ë“œì‚¬ë³„ ë§¤ì¶œ/ë§¤ì… ë‚´ì—­ ìë™ ìˆ˜ì§‘\nâ€¢ ì¹´ë“œ ì‚¬ìš©ë‚´ì—­ê³¼ ì¦ë¹™ ë§¤ì¹­\nâ€¢ ê°œì¸ê²½ë¹„ vs ë²•ì¸ê²½ë¹„ êµ¬ë¶„ ê´€ë¦¬',
                effect: 'ì¹´ë“œ ì‚¬ìš©ë‚´ì—­ì˜ ì ê²©ì¦ë¹™ í™•ë³´ë¡œ ì„¸ë¬´ ë¦¬ìŠ¤í¬ë¥¼ ìµœì†Œí™”í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ì›”ë³„ ì¹´ë“œì‚¬ìš© ëª…ì„¸ì„œ, ë¶€ê°€ì„¸ ë§¤ì…ìë£Œ'
            },
            partnerManagement: {
                category: 'ê¸°ë³¸ ê´€ë¦¬',
                title: 'ê±°ë˜ì²˜ ë° ì§ì› ê´€ë¦¬',
                icon: 'ğŸ‘¥',
                method: 'ê±°ë˜ì²˜ ì •ë³´ì™€ ì§ì› ì •ë³´ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ë“±ë¡í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ê±°ë˜ì²˜ ê¸°ë³¸ì •ë³´ ë° ë‹´ë‹¹ì ê´€ë¦¬\nâ€¢ ê±°ë˜ì²˜ë³„ ê±°ë˜ì¡°ê±´ ë° ê²°ì œì¡°ê±´ ê´€ë¦¬\nâ€¢ ì§ì› ê¸°ë³¸ì •ë³´, ê¸‰ì—¬ì •ë³´, ì…í‡´ì‚¬ ê´€ë¦¬',
                effect: 'ê±°ë˜ì²˜/ì§ì› ì •ë³´ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ì—¬ ì—…ë¬´ íš¨ìœ¨ì„±ì„ ë†’ì…ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ìë£Œ: ê±°ë˜ì²˜ ì›ì¥, ì§ì› ë§ˆìŠ¤í„°'
            },
            // === ì„¸ê¸ˆê³„ì‚°ì„œ ì„œë¹„ìŠ¤ ===
            taxInvoiceIssue: {
                category: 'ì„¸ê¸ˆê³„ì‚°ì„œ',
                title: 'ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰',
                icon: 'ğŸ“„',
                method: 'ì—…ë¬´ì˜ ì •í™•ì„±ì„ ìœ„í•´ ì‹¤ì‹œê°„ ê±´ë³„ ë°œí–‰ì´ ì•„ë‹Œ, ì‚¬ì „ì— í˜‘ì˜ëœ ì‹œê°„ì— ì¼ê´„ ë°œí–‰í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ë°œí–‰ ìš”ì²­ ì ‘ìˆ˜ ë° ê²€ì¦\nâ€¢ í˜‘ì˜ëœ ì‹œê°„ì— ì¼ê´„ ë°œí–‰ (ì˜ˆ: ë§¤ì¼ ì˜¤í›„ 5ì‹œ)\nâ€¢ ë°œí–‰ ì™„ë£Œ ë‚´ì—­ ë³´ê³ ',
                effect: 'ë°œí–‰ ëˆ„ë½ ë°©ì§€ ë° ê²€ì¦ ì ˆì°¨ë¡œ ì„¸ë¬´ ë¦¬ìŠ¤í¬ë¥¼ ìµœì†Œí™”í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ì¼ë³„/ì›”ë³„ ë°œí–‰ ë‚´ì—­ì„œ'
            },
            taxInvoiceCheck: {
                category: 'ì„¸ê¸ˆê³„ì‚°ì„œ',
                title: 'ì„¸ê¸ˆê³„ì‚°ì„œ ì¡°íšŒ/ê´€ë¦¬',
                icon: 'ğŸ”',
                method: 'êµ­ì„¸ì²­ í™ˆíƒìŠ¤ì™€ ì—°ë™í•˜ì—¬ ë§¤ì¶œ/ë§¤ì… ì„¸ê¸ˆê³„ì‚°ì„œë¥¼ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ í™ˆíƒìŠ¤ ë§¤ì¶œ/ë§¤ì… ì„¸ê¸ˆê³„ì‚°ì„œ ìë™ ìˆ˜ì§‘\nâ€¢ ë¯¸ìˆ˜ì·¨/ë¯¸ë°œí–‰ ì„¸ê¸ˆê³„ì‚°ì„œ ì²´í¬\nâ€¢ ì„¸ê¸ˆê³„ì‚°ì„œ vs ì…ì¶œê¸ˆ ë‚´ì—­ ëŒ€ì‚¬',
                effect: 'ì„¸ê¸ˆê³„ì‚°ì„œ ëˆ„ë½ì„ ë°©ì§€í•˜ê³  ë¶€ê°€ì„¸ ì‹ ê³  ì •í™•ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ì›”ë³„ ì„¸ê¸ˆê³„ì‚°ì„œ ìˆ˜ì·¨í˜„í™©í‘œ'
            },
            // === ë§¤ì¶œ/ì†ìµ ê´€ë¦¬ ===
            monthlyPL: {
                category: 'ì†ìµ ë¶„ì„',
                title: 'ì›”ê°„ ì†ìµë¶„ì„',
                icon: 'ğŸ“ˆ',
                method: 'ê²½ë¦¬ë‚˜ë¼ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²½ì˜ ê´€ë¦¬ë¥¼ ìœ„í•œ ê´€ë¦¬íšŒê³„ìš© ì†ìµë³´ê³ ì„œë¥¼ ë§¤ì›” ì œê³µí•©ë‹ˆë‹¤.',
                detail: 'â€¢ ë§¤ì¶œ/ë§¤ì…/ë¹„ìš© í•­ëª©ë³„ ì§‘ê³„\nâ€¢ ì „ì›” ëŒ€ë¹„ ì¦ê° ë¶„ì„\nâ€¢ ì†ìµ ì¶”ì´ ê·¸ë˜í”„ ì œê³µ',
                effect: 'ì •í™•í•œ ì†ìµ í˜„í™© íŒŒì•…ìœ¼ë¡œ ê²½ì˜ ì˜ì‚¬ê²°ì •ì„ ì§€ì›í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ì›”ë³„ ì†ìµê³„ì‚°ì„œ, ë¹„ìš© ë¶„ì„í‘œ'
            },
            projectPL: {
                category: 'ì†ìµ ë¶„ì„',
                title: 'í”„ë¡œì íŠ¸/í˜„ì¥ë³„ ì†ìµë¶„ì„',
                icon: 'ğŸ—ï¸',
                method: 'í”„ë¡œì íŠ¸, í˜„ì¥, í’ˆëª©ë³„ë¡œ ë§¤ì¶œê³¼ ë¹„ìš©ì„ êµ¬ë¶„í•˜ì—¬ ê°œë³„ ì†ìµì„ ë¶„ì„í•©ë‹ˆë‹¤.',
                detail: 'â€¢ í”„ë¡œì íŠ¸/í˜„ì¥/í’ˆëª© ì½”ë“œ ì„¤ì •\nâ€¢ ë§¤ì¶œ-ë¹„ìš© ê°œë³„ ë§¤ì¹­ ì²˜ë¦¬\nâ€¢ í”„ë¡œì íŠ¸ë³„ ìˆ˜ìµë¥  ë¶„ì„',
                effect: 'ìˆ˜ìµì„± ë†’ì€ ì‚¬ì—… ì˜ì—­ì„ íŒŒì•…í•˜ê³  ì „ëµì  ì˜ì‚¬ê²°ì •ì— í™œìš©í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: í”„ë¡œì íŠ¸ë³„ ì†ìµí˜„í™©í‘œ, í˜„ì¥ë³„ ì›ê°€ë¶„ì„í‘œ'
            },
            salesManagement: {
                category: 'ì†ìµ ë¶„ì„',
                title: 'í’ˆëª©ë³„/í”„ë¡œì íŠ¸ë³„ ë§¤ì¶œê´€ë¦¬',
                icon: 'ğŸ’°',
                method: 'í’ˆëª©ì´ë‚˜ í”„ë¡œì íŠ¸ ë‹¨ìœ„ë¡œ ë§¤ì¶œì„ ì¶”ì í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ í’ˆëª©ë³„ ë§¤ì¶œ í˜„í™© ì§‘ê³„\nâ€¢ ê±°ë˜ì²˜ë³„ í’ˆëª© ë§¤ì¶œ ë¶„ì„\nâ€¢ ë§¤ì¶œ ì¶”ì´ ë° ì˜ˆì¸¡',
                effect: 'ì£¼ë ¥ ìƒí’ˆ/ì„œë¹„ìŠ¤ë¥¼ íŒŒì•…í•˜ê³  ë§¤ì¶œ ì „ëµ ìˆ˜ë¦½ì— í™œìš©í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: í’ˆëª©ë³„ ë§¤ì¶œí˜„í™©í‘œ, ë§¤ì¶œì¶”ì´ë¶„ì„í‘œ'
            },
            // === ìê¸ˆ ê´€ë¦¬ ===
            arApManagement: {
                category: 'ìê¸ˆ ê´€ë¦¬',
                title: 'ë¯¸ìˆ˜/ë¯¸ì§€ê¸‰ê¸ˆ ê´€ë¦¬',
                icon: 'ğŸ“‹',
                method: "ê²½ë¦¬ë‚˜ë¼ë¥¼ í™œìš©í•˜ì—¬ ê±°ë˜ì²˜ë³„ ë¯¸ìˆ˜ê¸ˆ/ë¯¸ì§€ê¸‰ê¸ˆ í˜„í™©ì„ ì •í™•í•˜ê²Œ íŒŒì•…í•©ë‹ˆë‹¤.",
                detail: 'â€¢ ê±°ë˜ì²˜ë³„ ë¯¸ìˆ˜/ë¯¸ì§€ê¸‰ ì”ì•¡ ê´€ë¦¬\nâ€¢ ì—°ì²´ í˜„í™© ë° íšŒìˆ˜ìœ¨ ë¶„ì„\nâ€¢ ì±„ê¶Œ ì—°ë ¹ ë¶„ì„ (Aging)',
                effect: 'ì±„ê¶Œ/ì±„ë¬´ í˜„í™©ì„ ì •í™•íˆ íŒŒì•…í•˜ì—¬ ìê¸ˆ ê³„íšì— í™œìš©í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ë¯¸ìˆ˜ê¸ˆ í˜„í™©í‘œ, ë¯¸ì§€ê¸‰ê¸ˆ í˜„í™©í‘œ, Aging ë¶„ì„í‘œ'
            },
            cashFlowManagement: {
                category: 'ìê¸ˆ ê´€ë¦¬',
                title: 'ìê¸ˆí˜„í™© ê´€ë¦¬',
                icon: 'ğŸ’µ',
                method: 'ì¼ì¼/ì£¼ê°„/ì›”ê°„ ìê¸ˆ í˜„í™©ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ë³´ê³ í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ìê¸ˆì¼ë³´ ì‘ì„± ë° ë³´ê³ \nâ€¢ ì˜ˆìƒ ì…ì¶œê¸ˆ ìŠ¤ì¼€ì¤„ ê´€ë¦¬\nâ€¢ ìê¸ˆ ë¶€ì¡± ì˜ˆì¸¡ ì•Œë¦¼',
                effect: 'ìê¸ˆ íë¦„ì„ ì˜ˆì¸¡í•˜ì—¬ ìœ ë™ì„± ë¦¬ìŠ¤í¬ë¥¼ ì‚¬ì „ì— ë°©ì§€í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ìê¸ˆì¼ë³´, ì£¼ê°„ ìê¸ˆê³„íší‘œ'
            },
            bankReconciliation: {
                category: 'ìê¸ˆ ê´€ë¦¬',
                title: 'ì…ì¶œê¸ˆë‚´ì—­ ëŒ€ì‚¬',
                icon: 'ğŸ”„',
                method: 'ì€í–‰ ì…ì¶œê¸ˆ ë‚´ì—­ì„ ì„¸ê¸ˆê³„ì‚°ì„œ, ì¹´ë“œë§¤ì¶œ ë“± ì¦ë¹™ê³¼ ë§¤ì¹­í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ì…ê¸ˆ ë‚´ì—­ â†” ì„¸ê¸ˆê³„ì‚°ì„œ ë§¤ì¹­\nâ€¢ ì¶œê¸ˆ ë‚´ì—­ â†” ì§€ì¶œì¦ë¹™ ë§¤ì¹­\nâ€¢ ë¯¸í™•ì¸ ê±°ë˜ ì¶”ì  ë° í™•ì¸',
                effect: 'ëª¨ë“  ê±°ë˜ì˜ ì¦ë¹™ì„ í™•ë³´í•˜ì—¬ íšŒê³„ íˆ¬ëª…ì„±ì„ ë†’ì…ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ì…ì¶œê¸ˆ ëŒ€ì‚¬í‘œ, ë¯¸í™•ì¸ê±°ë˜ ëª©ë¡'
            },
            // === ì¦ë¹™/ì„¸ë¬´ ì§€ì› ===
            documentManagement: {
                category: 'ì¦ë¹™/ì„¸ë¬´',
                title: 'ì¦ë¹™ê´€ë¦¬',
                icon: 'ğŸ“',
                method: 'ì„¸ê¸ˆê³„ì‚°ì„œ, ì¹´ë“œì „í‘œ, í˜„ê¸ˆì˜ìˆ˜ì¦ ë“± ëª¨ë“  ì¦ë¹™ì„ ì²´ê³„ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ì „ìì„¸ê¸ˆê³„ì‚°ì„œ ìë™ ìˆ˜ì§‘\nâ€¢ ì¹´ë“œ ë§¤ì¶œì „í‘œ ìˆ˜ì§‘ ë° ì •ë¦¬\nâ€¢ ê°„ì´ì˜ìˆ˜ì¦/í˜„ê¸ˆì˜ìˆ˜ì¦ ê´€ë¦¬',
                effect: 'ì¦ë¹™ ëˆ„ë½ ì—†ì´ ì™„ë²½í•œ ì¥ë¶€ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ìë£Œ: ì›”ë³„ ì¦ë¹™ ìˆ˜ì§‘í˜„í™©í‘œ'
            },
            taxSupport: {
                category: 'ì¦ë¹™/ì„¸ë¬´',
                title: 'ì„¸ë¬´ì‹ ê³  ë³´ì¡°ìë£Œ',
                icon: 'ğŸ“',
                method: 'ë¶€ê°€ì„¸, ì›ì²œì„¸ ë“± ì„¸ë¬´ ì‹ ê³ ì— í•„ìš”í•œ ê¸°ì´ˆ ìë£Œë¥¼ ì •ë¦¬í•˜ì—¬ ì œê³µí•©ë‹ˆë‹¤.',
                detail: 'â€¢ ë¶€ê°€ì„¸ ì‹ ê³ ìš© ë§¤ì¶œ/ë§¤ì… ì§‘ê³„\nâ€¢ ì›ì²œì„¸ ì‹ ê³ ìš© ê¸‰ì—¬ ìë£Œ ì •ë¦¬\nâ€¢ ì„¸ë¬´ì‚¬ ì „ë‹¬ìš© ìë£Œ íŒ¨í‚¤ì§€',
                effect: 'ì„¸ë¬´ëŒ€ë¦¬ì¸ê³¼ì˜ ì›í™œí•œ í˜‘ì—…ìœ¼ë¡œ ì‹ ê³  ì˜¤ë¥˜ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ìë£Œ: ë¶€ê°€ì„¸ ì‹ ê³ ìë£Œ, ì›ì²œì„¸ ì‹ ê³ ìë£Œ'
            },
            // === ê¸°íƒ€ ì„œë¹„ìŠ¤ ===
            statementIssue: {
                category: 'ê¸°íƒ€',
                title: 'ê±°ë˜ëª…ì„¸í‘œ ì œì‘',
                icon: 'ğŸ“ƒ',
                method: 'ê±°ë˜ì²˜ì— ë°œì†¡í•  ê±°ë˜ëª…ì„¸í‘œë¥¼ ì‘ì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ê±°ë˜ëª…ì„¸í‘œ ì–‘ì‹ ì„¤ì •\nâ€¢ í’ˆëª©ë³„/ê±°ë˜ì²˜ë³„ ëª…ì„¸í‘œ ìƒì„±\nâ€¢ ë°œì†¡ ì´ë ¥ ê´€ë¦¬',
                effect: 'ì „ë¬¸ì ì¸ ê±°ë˜ëª…ì„¸í‘œë¡œ ê±°ë˜ì²˜ì™€ì˜ ì‹ ë¢°ë¥¼ ë†’ì…ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ìë£Œ: ê±°ë˜ëª…ì„¸í‘œ í…œí”Œë¦¿'
            },
            payroll: {
                category: 'ê¸°íƒ€',
                title: 'ê¸‰ì—¬ ì •ì‚°',
                icon: 'ğŸ’¼',
                method: 'í™•ì •ëœ ê·¼íƒœ ë° ë³€ë™ ë‚´ì—­ì„ ë°”íƒ•ìœ¼ë¡œ ê¸‰ì—¬ ëŒ€ì¥ì„ ì‘ì„±í•˜ê³ , ì„¸ë¬´ëŒ€ë¦¬ì¸ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.',
                detail: 'â€¢ ê·¼íƒœ ë°ì´í„° ê¸°ë°˜ ê¸‰ì—¬ ê³„ì‚°\nâ€¢ 4ëŒ€ë³´í—˜ë£Œ ê³„ì‚°\nâ€¢ ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±',
                effect: 'ì •í™•í•œ ê¸‰ì—¬ ì²˜ë¦¬ë¡œ ì§ì› ë§Œì¡±ë„ì™€ ì„¸ë¬´ ì •í™•ì„±ì„ ë†’ì…ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ë³´ê³ ì„œ: ê¸‰ì—¬ëŒ€ì¥, ê¸‰ì—¬ëª…ì„¸ì„œ'
            },
            customTool: {
                category: 'ê¸°íƒ€',
                title: 'ë§ì¶¤ ë³´ì¡° ë„êµ¬ ê°œë°œ',
                icon: 'ğŸ› ï¸',
                method: 'ê·€ì‚¬ì˜ ì—…ë¬´ íŠ¹ì„±ì— ë§ëŠ” ë§ì¶¤í˜• ì—‘ì…€/ë³´ê³ ì„œ ì–‘ì‹ì„ ê°œë°œí•©ë‹ˆë‹¤.',
                detail: 'â€¢ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ ë¶„ì„\nâ€¢ ë§ì¶¤í˜• ì–‘ì‹/ë„êµ¬ ì„¤ê³„\nâ€¢ ì‚¬ìš© êµìœ¡ ë° ì§€ì›',
                effect: 'ë°˜ë³µ ì—…ë¬´ë¥¼ ìë™í™”í•˜ì—¬ ì—…ë¬´ íš¨ìœ¨ì„±ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.',
                sample: 'ğŸ“Š ì œê³µ ìë£Œ: ë§ì¶¤ ê°œë°œ ì–‘ì‹'
            }
        };

        // ì €ì¥ëœ ì„œë¹„ìŠ¤ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©
        let serviceData = JSON.parse(localStorage.getItem('serviceData')) || JSON.parse(JSON.stringify(defaultServiceData));

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            updateSelectionCount();
            loadSavedData();
        });

        // ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSavedData() {
            let hasData = false;
            
            // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸°
            const savedContent = localStorage.getItem('editedContent');
            if (savedContent) {
                try {
                    const content = JSON.parse(savedContent);
                    // ë¬¸ì„œ ë‚´ìš© ë³µì›ì€ updatePreview í›„ì— ì ìš©
                    window.savedEditContent = content;
                    if (Object.keys(content).length > 0) hasData = true;
                } catch (e) {
                    console.error('ì €ì¥ëœ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', e);
                }
            }

            // ì €ì¥ëœ ì„œë¹„ìŠ¤ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
            const savedServiceData = localStorage.getItem('serviceData');
            if (savedServiceData) {
                try {
                    serviceData = JSON.parse(savedServiceData);
                    hasData = true;
                } catch (e) {
                    console.error('ì„œë¹„ìŠ¤ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', e);
                }
            }
            
            // ì €ì¥ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ìƒíƒœ í‘œì‹œ
            if (hasData) {
                setTimeout(() => {
                    updateSaveStatus('saved');
                    showToast('ì´ì „ì— ì €ì¥ëœ ë‚´ìš©ì´ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤', 'success');
                }, 500);
            }
        }

        // í¸ì§‘ ë‚´ìš© ì €ì¥
        function saveEditedContent() {
            const editables = document.querySelectorAll('#documentContent [data-key]');
            const content = {};
            
            editables.forEach(el => {
                const key = el.getAttribute('data-key');
                if (key) {
                    content[key] = el.innerHTML;
                }
            });
            
            localStorage.setItem('editedContent', JSON.stringify(content));
        }

        // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ì ìš©
        function applySavedContent() {
            if (window.savedEditContent) {
                Object.keys(window.savedEditContent).forEach(key => {
                    const el = document.querySelector(`[data-key="${key}"]`);
                    if (el) {
                        el.innerHTML = window.savedEditContent[key];
                    }
                });
            }
        }

        // ì„œë¹„ìŠ¤ ë°ì´í„° ì €ì¥
        function saveServiceData() {
            localStorage.setItem('serviceData', JSON.stringify(serviceData));
        }

        // ìë™ ì €ì¥ (ë””ë°”ìš´ìŠ¤)
        function autoSave() {
            clearTimeout(saveTimeout);
            updateSaveStatus('saving');
            
            saveTimeout = setTimeout(() => {
                saveAllContent();
                updateSaveStatus('saved');
            }, 1500);
        }

        // ìˆ˜ë™ ì €ì¥
        function manualSave() {
            updateSaveStatus('saving');
            saveAllContent();
            updateSaveStatus('saved');
            showToast('ë‚´ìš©ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        // ì €ì¥ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSaveStatus(status) {
            const statusEl = document.getElementById('saveStatus');
            const textEl = document.getElementById('saveStatusText');
            
            statusEl.className = 'save-status ' + status;
            
            if (status === 'saving') {
                textEl.textContent = 'ì €ì¥ ì¤‘...';
            } else if (status === 'saved') {
                textEl.textContent = 'ì €ì¥ ì™„ë£Œ (' + new Date().toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'}) + ')';
            } else {
                textEl.textContent = 'ìˆ˜ì • ë‚´ìš©ì´ ìë™ ì €ì¥ë©ë‹ˆë‹¤';
            }
        }


        // ì„œë¹„ìŠ¤ í† ê¸€ (ìƒˆ êµ¬ì¡°)
        function toggleService(checkbox, serviceId, type) {
            const item = checkbox.closest('.checkbox-item');
            const targetSet = type === 'recommended' ? recommendedServices : requestedServices;
            
            if (checkbox.checked) {
                targetSet.add(serviceId);
                item.classList.add('checked');
            } else {
                targetSet.delete(serviceId);
                item.classList.remove('checked');
            }
            
            updateSelectionCount();
            updatePreview();
        }

        // ì„ íƒ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        function updateSelectionCount() {
            document.getElementById('requestedCount').innerHTML = 
                `ì„ íƒ: <strong>${requestedServices.size}ê°œ</strong>`;
            document.getElementById('recommendedCount').innerHTML = 
                `ì„ íƒ: <strong>${recommendedServices.size}ê°œ</strong>`;
        }

        // ì„œë¹„ìŠ¤ ë°•ìŠ¤ HTML ìƒì„±
        function generateServiceBoxHTML(serviceId, data, type) {
            const typeLabel = type === 'recommended' ? 'ğŸ’¡ ê²½ì²­ ì¶”ì²œ' : 'ğŸ“Œ ê³ ê° ìš”ì²­';
            const typeBadgeClass = type === 'recommended' ? 'badge-recommended' : 'badge-requested';
            
            return `
                <div class="service-box ${type}" data-service-id="${serviceId}" style="page-break-inside: avoid; break-inside: avoid;">
                    <div class="service-header">
                        <span class="service-icon">${data.icon || 'ğŸ“‹'}</span>
                        <h4 data-editable data-key="svc_${serviceId}_title">${data.title}</h4>
                        <span class="service-badge ${typeBadgeClass}">${typeLabel}</span>
                    </div>
                    <div class="service-body">
                        <div class="info-row">
                            <span class="info-label">ìš´ì˜ ë°©ì‹</span>
                            <span class="info-value" data-editable data-key="svc_${serviceId}_method">${data.method}</span>
                        </div>
                        ${data.detail ? `
                        <div class="info-row">
                            <span class="info-label">ìƒì„¸ ë‚´ìš©</span>
                            <span class="info-value detail-text" data-editable data-key="svc_${serviceId}_detail">${data.detail.replace(/\n/g, '<br>')}</span>
                        </div>
                        ` : ''}
                        <div class="info-row">
                            <span class="info-label">ê¸°ëŒ€ íš¨ê³¼</span>
                            <span class="info-value" data-editable data-key="svc_${serviceId}_effect">${data.effect}</span>
                        </div>
                        ${data.sample ? `
                        <div class="sample-report">
                            ${data.sample}
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const companyName = document.getElementById('companyName').value.trim();
            const contactName = document.getElementById('contactName').value.trim();
            const emptyState = document.getElementById('emptyState');
            const documentContent = document.getElementById('documentContent');
            
            const totalServices = requestedServices.size + recommendedServices.size;
            
            if (totalServices === 0) {
                emptyState.style.display = 'block';
                documentContent.style.display = 'none';
                return;
            }
            
            emptyState.style.display = 'none';
            documentContent.style.display = 'block';
            
            // ê³ ê°ëª… ì—…ë°ì´íŠ¸
            let displayName = companyName || 'ê·€ì‚¬';
            if (contactName) {
                displayName += ` (${contactName})`;
            }
            document.getElementById('docClientName').textContent = displayName;
            
            // ì¶”ê°€ ì˜µì…˜ ì²˜ë¦¬
            const existingStaffBox = document.getElementById('existingStaffBox');
            if (existingStaffBox) {
                const optExistingStaff = document.getElementById('optExistingStaff');
                existingStaffBox.style.display = optExistingStaff && optExistingStaff.checked ? 'block' : 'none';
            }
            
            const erpSection = document.getElementById('erpSection');
            if (erpSection) {
                const optErpPromo = document.getElementById('optErpPromo');
                erpSection.style.display = optErpPromo && optErpPromo.checked ? 'block' : 'none';
            }
            
            // ì„œë¹„ìŠ¤ ì„¹ì…˜ ì—…ë°ì´íŠ¸
            const servicesSection = document.getElementById('selectedServicesSection');
            const servicesContent = document.getElementById('selectedServicesContent');
            
            if (totalServices > 0 && servicesSection && servicesContent) {
                servicesSection.style.display = 'block';
                
                let html = '';
                
                // ê³ ê° ìš”ì²­ ì„œë¹„ìŠ¤
                if (requestedServices.size > 0) {
                    html += `<div class="service-group">
                        <h3 class="service-group-title">ğŸ“Œ ê³ ê° ìš”ì²­ ì„œë¹„ìŠ¤ <span class="count">${requestedServices.size}ê°œ</span></h3>
                        <p class="service-group-desc">ê³ ê°ì‚¬ì—ì„œ í•„ìš”í•˜ë‹¤ê³  ìš”ì²­í•˜ì‹  ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</p>
                        <div class="service-grid">`;
                    
                    requestedServices.forEach(serviceId => {
                        const data = serviceData[serviceId];
                        if (data) {
                            html += generateServiceBoxHTML(serviceId, data, 'requested');
                        }
                    });
                    html += `</div></div>`;
                }
                
                // ê²½ì²­ ì¶”ì²œ ì„œë¹„ìŠ¤
                if (recommendedServices.size > 0) {
                    html += `<div class="service-group recommended-group-doc" style="page-break-before: always;">
                        <h3 class="service-group-title" style="color: var(--ai-purple);">ğŸ’¡ ê²½ì²­ ì¶”ì²œ ì„œë¹„ìŠ¤ <span class="count">${recommendedServices.size}ê°œ</span></h3>
                        <p class="service-group-desc">ê²½ì²­ì—ì„œ ì¶”ê°€ë¡œ ì œì•ˆë“œë¦¬ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ê·€ì‚¬ì˜ ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒì— ë„ì›€ì´ ë  ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.</p>
                        <div class="service-grid">`;
                    
                    recommendedServices.forEach(serviceId => {
                        const data = serviceData[serviceId];
                        if (data) {
                            html += generateServiceBoxHTML(serviceId, data, 'recommended');
                        }
                    });
                    html += `</div></div>`;
                }
                
                servicesContent.innerHTML = html;
            } else {
                servicesSection.style.display = 'none';
            }
            
            // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ì ìš©
            applySavedContent();
            
            if (isEditMode) {
                applyEditMode(true);
            }
        }

        // í¸ì§‘ ëª¨ë“œ
        function toggleEditMode() {
            isEditMode = !isEditMode;
            const docEl = document.getElementById('document');
            const editBtn = document.getElementById('editBtn');
            
            if (isEditMode) {
                applyEditMode(true);
                docEl.classList.add('edit-mode');
                editBtn.innerHTML = `
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    í¸ì§‘ ì™„ë£Œ & ì €ì¥
                `;
                editBtn.classList.remove('btn-primary');
                editBtn.classList.add('btn-success');
                showToast('í¸ì§‘ ëª¨ë“œ - í…ìŠ¤íŠ¸ë¥¼ í´ë¦­í•˜ì—¬ ìˆ˜ì •í•˜ì„¸ìš”. ìˆ˜ì • ë‚´ìš©ì€ ìë™ ì €ì¥ë©ë‹ˆë‹¤.');
            } else {
                // í¸ì§‘ ë‚´ìš© ì €ì¥
                updateSaveStatus('saving');
                saveAllContent();
                updateSaveStatus('saved');
                
                applyEditMode(false);
                docEl.classList.remove('edit-mode');
                editBtn.innerHTML = `
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    ë‚´ìš© í¸ì§‘ ëª¨ë“œ
                `;
                editBtn.classList.remove('btn-success');
                editBtn.classList.add('btn-primary');
                showToast('í¸ì§‘ ë‚´ìš©ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }
        }

        function applyEditMode(enable) {
            document.querySelectorAll('[data-editable]').forEach(el => {
                if (enable) {
                    el.setAttribute('contenteditable', 'true');
                    el.addEventListener('input', handleEditInput);
                } else {
                    el.removeAttribute('contenteditable');
                    el.removeEventListener('input', handleEditInput);
                }
            });
        }

        // í¸ì§‘ ì…ë ¥ í•¸ë“¤ëŸ¬
        function handleEditInput(e) {
            const el = e.target;
            const serviceField = el.getAttribute('data-service-field');
            const serviceBox = el.closest('[data-service-id]');
            
            // ì„œë¹„ìŠ¤ ë°ì´í„° ì—…ë°ì´íŠ¸
            if (serviceField && serviceBox) {
                const serviceId = serviceBox.getAttribute('data-service-id');
                if (serviceData[serviceId]) {
                    serviceData[serviceId][serviceField] = el.innerHTML;
                }
            }
            
            // ìë™ ì €ì¥ íŠ¸ë¦¬ê±°
            autoSave();
        }

        // ëª¨ë“  ë‚´ìš© ì €ì¥
        function saveAllContent() {
            // ì¼ë°˜ í¸ì§‘ ë‚´ìš© ì €ì¥
            saveEditedContent();
            
            // ì„œë¹„ìŠ¤ ë°ì´í„° ì €ì¥
            saveServiceData();
            
            // savedEditContent ì—…ë°ì´íŠ¸
            const savedContent = localStorage.getItem('editedContent');
            if (savedContent) {
                window.savedEditContent = JSON.parse(savedContent);
            }
        }

        // PDF ë‚´ë³´ë‚´ê¸° (ë¸Œë¼ìš°ì € ì¸ì‡„ ê¸°ëŠ¥ ì‚¬ìš©)
        function exportToPDF() {
            const totalServices = requestedServices.size + recommendedServices.size;
            if (totalServices === 0) {
                showToast('ì„œë¹„ìŠ¤ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            if (isEditMode) toggleEditMode();
            
            // ì¸ì‡„ ì „ ì‚¬ì´ë“œë°” ìˆ¨ê¸°ê¸°
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('.main-content');
            const document_el = document.getElementById('document');
            
            // ì¸ì‡„ìš© ìŠ¤íƒ€ì¼ ì ìš©
            sidebar.style.display = 'none';
            mainContent.style.marginLeft = '0';
            mainContent.style.width = '100%';
            document_el.style.maxWidth = '100%';
            document_el.style.margin = '0';
            document_el.style.padding = '30px 50px';
            document_el.style.boxShadow = 'none';
            
            // íŒŒì¼ëª… ì•ˆë‚´
            const companyName = document.getElementById('companyName').value.trim() || 'ê·€ì‚¬';
            showToast(`ì¸ì‡„ ëŒ€í™”ìƒìì—ì„œ "PDFë¡œ ì €ì¥"ì„ ì„ íƒí•˜ì„¸ìš”.\níŒŒì¼ëª…: ê²½ì²­_ì„œë¹„ìŠ¤ì†Œê°œì„œ_${companyName}.pdf`, 'info');
            
            // ì•½ê°„ì˜ ë”œë ˆì´ í›„ ì¸ì‡„
            setTimeout(() => {
                window.print();
                
                // ì¸ì‡„ í›„ ì›ë˜ ìŠ¤íƒ€ì¼ ë³µì›
                setTimeout(() => {
                    sidebar.style.display = '';
                    mainContent.style.marginLeft = '';
                    mainContent.style.width = '';
                    document_el.style.maxWidth = '';
                    document_el.style.margin = '';
                    document_el.style.padding = '';
                    document_el.style.boxShadow = '';
                }, 500);
            }, 300);
        }
        
        // ì¸ì‡„í•˜ê¸° (í”„ë¦°í„°ë¡œ ì§ì ‘ ì¸ì‡„)
        function printDocument() {
            const totalServices = requestedServices.size + recommendedServices.size;
            if (totalServices === 0) {
                showToast('ì„œë¹„ìŠ¤ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            if (isEditMode) toggleEditMode();
            
            showToast('ì¸ì‡„ ëŒ€í™”ìƒìê°€ ì—´ë¦½ë‹ˆë‹¤. ë°°ê²½ ê·¸ë˜í”½ ì˜µì…˜ì„ ì²´í¬í•´ì£¼ì„¸ìš”!', 'info');
            
            setTimeout(() => {
                window.print();
            }, 300);
        }

        // ì´ˆê¸°í™”
        function resetAll() {
            if (confirm('ëª¨ë“  ì„ íƒ, ì…ë ¥ ë° ì €ì¥ëœ í¸ì§‘ ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // UI ì´ˆê¸°í™”
                document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => {
                    cb.checked = false;
                    cb.closest('.checkbox-item').classList.remove('checked', 'ai-recommended');
                });
                
                const optErpPromo = document.getElementById('optErpPromo');
                const optExistingStaff = document.getElementById('optExistingStaff');
                if (optErpPromo) optErpPromo.checked = true;
                if (optExistingStaff) optExistingStaff.checked = false;
                
                document.getElementById('companyName').value = '';
                document.getElementById('contactName').value = '';
                document.getElementById('industryType').value = '';
                
                // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ì‚­ì œ
                localStorage.removeItem('editedContent');
                localStorage.removeItem('serviceData');
                window.savedEditContent = null;
                
                // ì„œë¹„ìŠ¤ ë°ì´í„° ì´ˆê¸°í™”
                serviceData = JSON.parse(JSON.stringify(defaultServiceData));
                
                requestedServices.clear();
                recommendedServices.clear();
                
                const aiResult = document.getElementById('aiResult');
                if (aiResult) aiResult.classList.remove('show');
                
                updateSelectionCount();
                updatePreview();
                
                // ì €ì¥ ìƒíƒœ ì´ˆê¸°í™”
                const saveStatus = document.getElementById('saveStatus');
                const saveStatusText = document.getElementById('saveStatusText');
                if (saveStatus) saveStatus.className = 'save-status';
                if (saveStatusText) saveStatusText.textContent = 'ìˆ˜ì • ë‚´ìš©ì´ ìë™ ì €ì¥ë©ë‹ˆë‹¤';
                
                showToast('ëª¨ë“  ë‚´ìš©ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        // í† ìŠ¤íŠ¸
        function showToast(message, type = '') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = 'toast' + (type ? ' ' + type : '');
            toastMessage.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
    </script>
</body>
</html>
